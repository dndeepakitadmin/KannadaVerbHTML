import tkinter as tk
from tkinter import ttk, messagebox
from docx import Document
import os

# --------------------------------------------------------
# ü™∂ 50 Common Kannada Verbs
# --------------------------------------------------------
verbs = {
    "‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≥Å": "eat", "‡≤ï‡≥Å‡≤°‡≤ø": "drink", "‡≤ì‡≤¶‡≥Å": "read", "‡≤¨‡≤∞‡≥Ü‡≤Ø‡≥Å": "write",
    "‡≤π‡≥ã‡≤ó‡≥Å": "go", "‡≤¨‡≤æ": "come", "‡≤®‡≥ã‡≤°‡≥Å": "see", "‡≤ï‡≥á‡≤≥‡≥Å": "listen",
    "‡≤Æ‡≤≤‡≤ó‡≥Å": "sleep", "‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≥Å": "stand", "‡≤ï‡≥Å‡≤≥‡≤ø‡≤§‡≥Å": "sit", "‡≤ï‡≥Ç‡≤∞‡≥Å": "sit (alt)",
    "‡≤®‡≤ó‡≥Å": "laugh", "‡≤Ö‡≤≥‡≥Å": "cry", "‡≤®‡≤°‡≥Ü‡≤Ø‡≥Å": "walk", "‡≤ì‡≤°‡≥Å": "run",
    "‡≤è‡≤≥‡≥Å": "wake up", "‡≤§‡≤ó‡≥Ü‡≤¶‡≥Å‡≤ï‡≥ã": "take", "‡≤ï‡≥ä‡≤°‡≥Å": "give", "‡≤á‡≤°‡≥Å": "keep",
    "‡≤§‡≥Ü‡≤∞‡≥Ü": "open", "‡≤Æ‡≥Å‡≤ö‡≥ç‡≤ö‡≥Å": "close", "‡≤§‡≥ã‡≤∞‡≤ø‡≤∏‡≥Å": "show", "‡≤π‡≥á‡≤≥‡≥Å": "say/tell",
    "‡≤Æ‡≤æ‡≤°‡≥Å": "do/make", "‡≤á‡≤∞‡≥Å": "be/stay", "‡≤¨‡≤∏‡≥Å": "live", "‡≤§‡≤ó‡≥Ü": "hold",
    "‡≤¨‡≥Ä‡≤≥‡≥Å": "fall", "‡≤®‡≤ø‡≤≤‡≥ç‡≤≤‡≤ø‡≤∏‡≥Å": "stop", "‡≤π‡≤∞‡≤ø": "flow/run", "‡≤Ü‡≤°‡≥Å": "play",
    "‡≤ï‡≤≤‡≤ø‡≤§‡≥Å‡≤ï‡≥ã": "learn", "‡≤®‡≥Ü‡≤®‡≤™‡≥Å‡≤Æ‡≤æ‡≤°‡≥Å": "remember", "‡≤Æ‡≤∞‡≥Ü‡≤§‡≥Å‡≤¨‡≤ø‡≤°‡≥Å": "forget",
    "‡≤®‡≥ã‡≤°‡≤ø‡≤ï‡≥ä‡≤≥‡≥ç‡≤≥‡≥Å": "take care", "‡≤π‡≥ã‡≤ó‡≤ø‡≤¨‡≤ø‡≤°‡≥Å": "leave", "‡≤§‡≤∞‡≤≤‡≥Å": "bring",
    "‡≤ï‡≤§‡≥ç‡≤§‡≤∞‡≤ø‡≤∏‡≥Å": "cut", "‡≤§‡≥ä‡≤≥‡≥Ü‡≤Ø‡≥Å": "wash", "‡≤§‡≤ø‡≤®‡≥ç‡≤®‡≤ø‡≤∏‡≥Å": "feed", "‡≤π‡≥ä‡≤°‡≥Ü": "hit",
    "‡≤π‡≤ø‡≤°‡≤ø": "catch", "‡≤ì‡≤¶‡≤ø": "study", "‡≤π‡≤æ‡≤°‡≥Å": "sing", "‡≤®‡≥É‡≤§‡≥ç‡≤Ø‡≤Æ‡≤æ‡≤°‡≥Å": "dance",
    "‡≤ï‡≤≥‡≥Ü": "lose", "‡≤ó‡≥Ü‡≤≤‡≥ç‡≤≤‡≥Å": "win", "‡≤í‡≤ó‡≥Ü": "wash (clothes)", "‡≤∏‡≥á‡≤∞‡≤ø‡≤∏‡≥Å": "add/join"
}

# --------------------------------------------------------
# üßç Subjects & Tenses
# --------------------------------------------------------
subjects = {
    "‡≤®‡≤æ‡≤®‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤®‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    },
    "‡≤®‡≥Ä‡≤®‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤®‡≥Ä‡≤®‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤®‡≥Ä‡≤®‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤®‡≥Ä‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    },
    "‡≤Ö‡≤µ‡≤®‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤®‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    },
    "‡≤Ö‡≤µ‡≤≥‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤≥‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    },
    "‡≤®‡≤æ‡≤µ‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤µ‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤µ‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤®‡≤æ‡≤µ‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    },
    "‡≤Ö‡≤µ‡≤∞‡≥Å": {
        "‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤®‡≤ø‡≤®‡≥ç‡≤®‡≥Ü {}.",
        "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤à‡≤ó {}.",
        "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤": "‡≤Ö‡≤µ‡≤∞‡≥Å ‡≤®‡≤æ‡≤≥‡≥Ü {}."
    }
}

# --------------------------------------------------------
# üéØ Common Objects
# --------------------------------------------------------
objects = [
    "", "‡≤Ö‡≤®‡≥ç‡≤®", "‡≤®‡≥Ä‡≤∞‡≥Å", "‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï", "‡≤™‡≥Ü‡≤®‡≥ç", "‡≤Æ‡≤®‡≥Ü", "‡≤¨‡≤æ‡≤ó‡≤ø‡≤≤‡≥Å", "‡≤ï‡≤æ‡≤ó‡≤¶",
    "‡≤π‡≤£‡≥ç‡≤£‡≥Å", "‡≤π‡≥Ç‡≤µ‡≥Å", "‡≤ï‡≤æ‡≤´‡≤ø", "‡≤ü‡≤ø‡≤µ‡≤ø", "‡≤™‡≤æ‡≤†", "‡≤¨‡≤ü‡≥ç‡≤ü‡≥Ü", "‡≤ï‡≤æ‡≤∞‡≥Å",
    "‡≤ï‡≤Ç‡≤™‡≥ç‡≤Ø‡≥Ç‡≤ü‡≤∞‡≥ç", "‡≤Æ‡≥ä‡≤¨‡≥à‡≤≤‡≥ç", "‡≤ö‡≤ø‡≤§‡≥ç‡≤∞", "‡≤Æ‡≤ø‡≤§‡≥ç‡≤∞", "‡≤™‡≤æ‡≤†‡≤™‡≥Å‡≤∏‡≥ç‡≤§‡≤ï", "‡≤ï‡≥Ü‡≤≤‡≤∏"
]

# --------------------------------------------------------
# üß† Sentence Generator
# --------------------------------------------------------
def generate_sentence():
    subject = subject_cb.get()
    tense = tense_cb.get()
    verb = verb_cb.get()
    obj = object_cb.get()

    if not (subject and tense and verb):
        messagebox.showwarning("Incomplete", "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤é‡≤≤‡≥ç‡≤≤‡≤æ ‡≤Ü‡≤Ø‡≥ç‡≤ï‡≥Ü‡≤ó‡≤≥‡≤®‡≥ç‡≤®‡≥Å ‡≤Æ‡≤æ‡≤°‡≤ø.")
        return

    pattern = subjects[subject][tense]
    sentence = pattern.format(f"{obj} {verb}".strip())
    english = verbs.get(verb, "")
    result = f"{sentence}\n\nü™∂ English: {subject} {verb} {obj}".strip()
    result_var.set(result)

# --------------------------------------------------------
# üíæ Optional Export to Word
# --------------------------------------------------------
def export_to_doc():
    text = result_var.get()
    if not text.strip():
        messagebox.showinfo("Empty", "‡≤¶‡≤Ø‡≤µ‡≤ø‡≤ü‡≥ç‡≤ü‡≥Å ‡≤Æ‡≥ä‡≤¶‡≤≤‡≥Å ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø ‡≤∞‡≤ö‡≤ø‡≤∏‡≤ø.")
        return

    doc = Document()
    doc.add_heading("Kannada Sentence", level=1)
    doc.add_paragraph(text)
    filename = "Kannada_Sentence.docx"
    doc.save(filename)
    messagebox.showinfo("Saved", f"‚úÖ ‡≤´‡≥à‡≤≤‡≥ç ‡≤â‡≤≥‡≤ø‡≤∏‡≤≤‡≤æ‡≤ó‡≤ø‡≤¶‡≥Ü: {os.path.abspath(filename)}")

# --------------------------------------------------------
# ü™ü GUI
# --------------------------------------------------------
root = tk.Tk()
root.title("ü™∂ Kannada Sentence Generator (‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤ / ‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤ / ‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤)")
root.geometry("700x480")

tk.Label(root, text="‡≤µ‡≤ø‡≤∑‡≤Ø (Subject):", font=("Nirmala UI", 12)).pack(pady=4)
subject_cb = ttk.Combobox(root, values=list(subjects.keys()), font=("Nirmala UI", 12))
subject_cb.pack()

tk.Label(root, text="‡≤ï‡≤æ‡≤≤ (Tense):", font=("Nirmala UI", 12)).pack(pady=4)
tense_cb = ttk.Combobox(root, values=["‡≤≠‡≥Ç‡≤§‡≤ï‡≤æ‡≤≤", "‡≤µ‡≤∞‡≥ç‡≤§‡≤Æ‡≤æ‡≤®‡≤ï‡≤æ‡≤≤", "‡≤≠‡≤µ‡≤ø‡≤∑‡≥ç‡≤Ø‡≤ï‡≤æ‡≤≤"], font=("Nirmala UI", 12))
tense_cb.pack()

tk.Label(root, text="‡≤ï‡≥ç‡≤∞‡≤ø‡≤Ø‡≤æ‡≤™‡≤¶ (Verb):", font=("Nirmala UI", 12)).pack(pady=4)
verb_cb = ttk.Combobox(root, values=list(verbs.keys()), font=("Nirmala UI", 12))
verb_cb.pack()

tk.Label(root, text="‡≤µ‡≤∏‡≥ç‡≤§‡≥Å (Object):", font=("Nirmala UI", 12)).pack(pady=4)
object_cb = ttk.Combobox(root, values=objects, font=("Nirmala UI", 12))
object_cb.pack()

tk.Button(root, text="ü™∂ ‡≤µ‡≤æ‡≤ï‡≥ç‡≤Ø ‡≤∞‡≤ö‡≤ø‡≤∏‡≤ø (Generate Sentence)", font=("Nirmala UI", 13, "bold"), command=generate_sentence).pack(pady=10)
result_var = tk.StringVar()
tk.Label(root, textvariable=result_var, wraplength=650, justify="center", font=("Nirmala UI", 13), fg="blue").pack(pady=15)
tk.Button(root, text="üíæ Export to Word (optional)", font=("Nirmala UI", 12), command=export_to_doc).pack(pady=5)

root.mainloop()
